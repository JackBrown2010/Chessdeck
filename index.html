<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chess Deck-Building Battle - Animated</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
<style>
body { background: #1e1e2f; color: #eee; font-family: 'Roboto', sans-serif; display:flex; flex-direction:column; align-items:center; padding:20px; overflow:hidden; }
h1 { margin-bottom:10px; }
#board { border-collapse: collapse; box-shadow: 0 0 15px rgba(0,0,0,0.5); }
td { width:70px; height:70px; text-align:center; vertical-align:middle; position:relative; cursor:pointer; transition:0.2s; border-radius:5px; }
td.light { background:#f0d9b5; }
td.dark { background:#b58863; }
td.hover { box-shadow: inset 0 0 0 3px yellow; }
.piece-icon { font-size:36px; pointer-events:none; user-select:none; transition: transform 0.2s; }
.hp-bar { position:absolute; bottom:5px; left:5px; height:8px; width:60px; background:#555; border-radius:4px; overflow:hidden; }
.hp-fill { height:100%; width:100%; background:green; transition:width 0.3s, background 0.3s; }
#deck,#souls { display:flex; flex-direction:column; align-items:center; margin-top:10px; }
#cards { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
.card { background:linear-gradient(to bottom,#444,#222); padding:6px 12px; border-radius:8px; cursor:pointer; box-shadow:0 0 5px black; transition:0.2s; }
.card:hover { transform:translateY(-2px); box-shadow:0 0 12px gold; }
#souls { font-size:20px; margin-top:10px; }
#status { margin-top:10px; font-size:18px; }
.particle { position:absolute; width:6px; height:6px; background:orange; border-radius:50%; pointer-events:none; animation:particleAnim 0.5s forwards; }
@keyframes particleAnim { 0% {opacity:1; transform:translate(0,0);} 100% {opacity:0; transform:translate(var(--dx), var(--dy));} }
</style>
</head>
<body>

<h1>Chess Deck-Building Battle</h1>
<table id="board"></table>

<div id="deck">
  <h3>Your Deck:</h3>
  <div id="cards"></div>
</div>

<div id="souls">Souls: 0</div>
<div id="status"></div>

<script>
const rows=8,cols=8;
const board=[];
let playerDeck=[
  {name:'Pawn', hp:2, atk:1, cost:1, icon:'♙'},
  {name:'Knight', hp:3, atk:2, cost:3, icon:'♘'},
  {name:'Bishop', hp:2, atk:2, cost:3, icon:'♗'},
  {name:'Rook', hp:4, atk:3, cost:5, icon:'♖'},
  {name:'Queen', hp:5, atk:3, cost:7, icon:'♕'}
];
let playerHand=[];
let selectedPiece=null;
let turn='player';
let souls=0;

function createBoard(){
  const table=document.getElementById('board');
  for(let r=0;r<rows;r++){
    const row=[];
    const tr=document.createElement('tr');
    for(let c=0;c<cols;c++){
      const td=document.createElement('td');
      td.dataset.row=r;
      td.dataset.col=c;
      td.className=(r+c)%2===0?'light':'dark';
      td.addEventListener('click',()=>cellClick(r,c));
      tr.appendChild(td);
      row.push(null);
    }
    table.appendChild(tr);
    board.push(row);
  }
  setupEnemy(); drawBoard(); drawDeck(); drawHand(); updateStatus(); updateSouls();
}

function setupEnemy(){
  const layout=[['Rook','Knight','Bishop','Queen','King','Bishop','Knight','Rook'],['Pawn','Pawn','Pawn','Pawn','Pawn','Pawn','Pawn','Pawn']];
  const icons={'Pawn':'♟','Knight':'♞','Bishop':'♝','Rook':'♜','Queen':'♛','King':'♚'};
  for(let r=0;r<2;r++){
    for(let c=0;c<8;c++){
      const name=layout[r][c];
      board[r][c]={name,hp:name==='Pawn'?2:name==='Knight'?3:name==='Bishop'?2:name==='Rook'?4:name==='Queen'?5:6,atk:name==='Pawn'?1:name==='Knight'?2:name==='Bishop'?2:name==='Rook'?3:name==='Queen'?3:1,type:'enemy',maxHp:name==='Pawn'?2:name==='Knight'?3:name==='Bishop'?2:name==='Rook'?4:name==='Queen'?5:6,icon:icons[name]};
    }
  }
}

function drawBoard(){
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const td=document.querySelector(`td[data-row='${r}'][data-col='${c}']`);
      const piece=board[r][c]; td.innerHTML='';
      if(piece){
        const icon=document.createElement('div'); icon.className='piece-icon'; icon.textContent=piece.icon; td.appendChild(icon);
        const hpBar=document.createElement('div'); hpBar.className='hp-bar';
        const fill=document.createElement('div'); fill.className='hp-fill';
        const percent=Math.max(0,(piece.hp/piece.maxHp)*100); fill.style.width=percent+'%';
        if(percent>50) fill.style.background='green';
        else if(percent>20) fill.style.background='yellow';
        else fill.style.background='red';
        hpBar.appendChild(fill); td.appendChild(hpBar);
      }
      td.classList.remove('hover');
    }
  }
}

function drawDeck(){const div=document.getElementById('cards'); div.innerHTML='';
playerHand.forEach((card,index)=>{const c=document.createElement('div'); c.className='card'; c.textContent=`${card.icon} ${card.name} HP:${card.hp} ATK:${card.atk} Cost:${card.cost}`; c.onclick=()=>selectCard(index); div.appendChild(c); });}

function drawHand(){while(playerHand.length<3 && playerDeck.length>0){playerHand.push({...playerDeck[Math.floor(Math.random()*playerDeck.length)]});} drawDeck();}

function selectCard(index){if(turn!=='player'){alert("Not your turn!"); return;} const card=playerHand[index]; if(card.cost>souls){alert("Not enough souls!"); return;} selectedPiece={cardIndex:index,piece:card}; alert("Click an empty square on your side to place the piece.");}

function cellClick(r,c){
  if(turn!=='player') return; const piece=board[r][c];
  if(selectedPiece){ if(!piece && r>=4){board[r][c]={...selectedPiece.piece,type:'player',maxHp:selectedPiece.piece.hp}; souls-=selectedPiece.piece.cost; updateSouls(); playerHand.splice(selectedPiece.cardIndex,1); selectedPiece=null; endTurn(); drawBoard(); return;} else alert("Cannot place here!"); return;}
  if(piece && piece.type==='player'){if(confirm("Sacrifice this piece for "+piece.cost+" souls?")){souls+=piece.cost; updateSouls(); spawnParticles(r,c); board[r][c]=null; drawBoard(); return;} piece.moves=[]; selectedPiece={piece:piece,from:[r,c]}; drawBoard();}
}

function spawnParticles(r,c){const td=document.querySelector(`td[data-row='${r}'][data-col='${c}']`); for(let i=0;i<10;i++){const p=document.createElement('div'); p.className='particle'; const dx=(Math.random()-0.5)*50+'px'; const dy=(Math.random()-0.5)*50+'px'; p.style.setProperty('--dx',dx); p.style.setProperty('--dy',dy); td.appendChild(p); setTimeout(()=>p.remove(),500);}}

function updateSouls(){document.getElementById('souls').textContent="Souls: "+souls;}
function updateStatus(){document.getElementById('status').textContent="Turn: "+turn;}
function endTurn(){turn=turn==='player'?'enemy':'player'; drawHand(); updateStatus();}

createBoard();
</script>

</body>
</html>
